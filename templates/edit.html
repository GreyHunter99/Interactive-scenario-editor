{% extends 'base.html' %}

{% block head %}

{% endblock %}

{% block body %}
    <p><a href="{{ url_for('menu') }}">Menu główne</a></p>
    <p><a href="{{ url_for('editScenario') }}">Lista pytań</a></p>
    <div class="board">
        <form action="{{ url_for('edit') }}" method="post">
            <h2>Treść pytania:</h2>
            <p><input name='text' type="text" value="{{ session['scenario']['questions'][questionId]['text'] }}"></p>
            <p>
                <a href="{{ url_for('edit', createKeyWord=True) }}">Dodaj słowo kluczowe</a>
                <a href="{{ url_for('edit', createOptionalText=True) }}">Dodaj tekst opcjonalny</a>
            </p>
            <p>
                <a href="{{ url_for('edit', createAnswer=True) }}">Dodaj odpowiedź</a>
                <a class="deleteButton" href="{{ url_for('editScenario', deleteQuestion=True, questionId=session['questionId']) }}">Usuń pytanie</a>
            </p>
            {% if session['scenario']['questions'][questionId]['keyWords'] != {} %}
                <div class="block">
                    <h2>Słowa kluczowe:</h2>
                    {% for keyWordKey, keyWord in session['scenario']['questions'][questionId]['keyWords'].items() %}
                        <p><input name='keyWord{{ keyWordKey }}' type="text" value="{{ keyWord }}"></p>
                        <p><a class="deleteButton" href="{{ url_for('edit', deleteKeyWord=True, keyWordId=keyWordKey) }}">Usuń słowo kluczowe</a></p>
                    {% endfor %}
                </div>
            {% endif %}
            {% if session['scenario']['questions'][questionId]['optionalTexts'] != {} %}
                <div class="block">
                    <h2>Tekst opcjonalny:</h2>
                    {% for optionalTextKey, optionalText in session['scenario']['questions'][questionId]['optionalTexts'].items() %}
                        <h3>Treść tekstu {{ optionalTextKey|int + 1 }} :</h3>
                        <p><input name='optionalText{{ optionalTextKey }}' type="text" value="{{ optionalText['text'] }}"></p>
                        <h3>Pytanie warunkowe:</h3>
                        <p><select name="optionalTextConditionalQuestionId{{ optionalTextKey }}">
                            {% for questionKey, question in session['scenario']['questions'].items() %}
                                <option value="{{ questionKey }}"{% if session['scenario']['questions'][questionId]['optionalTexts'][optionalTextKey]['conditionalQuestionId'] == questionKey %} selected="selected"{% endif %}>{{ question['text'] }}</option>
                            {% endfor %}
                        </select></p>
                        <p><a class="deleteButton" href="{{ url_for('edit', deleteOptionalText=True, optionalTextId=optionalTextKey) }}">Usuń tekst opcjonalny</a></p>
                    {% endfor %}
                </div>
            {% endif %}
            {% if session['scenario']['questions'][questionId]['answers'] != {} %}
                <div class="block">
                    <h2>Odpowiedzi:</h2>
                    {% for answerKey, answer in session['scenario']['questions'][questionId]['answers'].items() %}
                        <h3>Treść odpowiedzi {{ answerKey|int + 1 }} :</h3>
                        <p><input name='answerText{{ answerKey }}' type="text" value="{{ answer['text'] }}"></p>
                        <h3>Pytanie docelowe:</h3>
                        <p><select name="answerQuestionId{{ answerKey }}">
                            {% for questionKey, question in session['scenario']['questions'].items() %}
                                <option value="{{ questionKey }}"{% if session['scenario']['questions'][questionId]['answers'][answerKey]['questionId'] == questionKey %} selected="selected"{% endif %}>{{ question['text'] }}</option>
                            {% endfor %}
                        </select></p>
                        <h3>Pytanie warunkowe:</h3>
                        <p><select name="answerConditionalQuestionId{{ answerKey }}">
                            <option value="" selected="selected">Żadne</option>
                            {% for conditionalQuestionKey, question in session['scenario']['questions'].items() %}
                                <option value="{{ conditionalQuestionKey }}"{% if session['scenario']['questions'][questionId]['answers'][answerKey]['conditionalQuestionId'] == conditionalQuestionKey %} selected="selected"{% endif %}>{{ question['text'] }}</option>
                            {% endfor %}
                        </select></p>
                        <p><a class="deleteButton" href="{{ url_for('edit', deleteAnswer=True, answerId=answerKey) }}">Usuń odpowiedź</a></p>
                    {% endfor %}
                </div>
            {% endif %}
            <input type="submit" value="Zatwierdź zmiany">
        </form>
    </div>
{% endblock %}