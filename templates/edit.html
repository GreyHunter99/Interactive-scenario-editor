{% extends 'base.html' %}

{% block head %}

{% endblock %}

{% block body %}
    <p><a href="{{ url_for('editScenario') }}">Lista pytań</a></p>
    <div class="board">
        <form action="{{ url_for('edit') }}" method="post">
            <div class="block">
                <h1>Treść pytania:</h1>
                <p><input name='text' type="text" required="required" value="{{ scenario['questions'][questionId]['text'] }}"></p>
                <p>
                    <a href="{{ url_for('edit', keyWord=True) }}">Dodaj słowo kluczowe</a>
                    <a href="{{ url_for('edit', optionalText=True) }}">Dodaj tekst opcjonalny</a>
                </p>
                <p>
                    <a href="{{ url_for('edit', answer=True) }}">Dodaj odpowiedź</a>
                    <a class="deleteButton" href="{{ url_for('deleteQuestion', questionId=session['questionId']) }}">Usuń pytanie</a>
                </p>
            </div>
            {% if scenario['questions'][questionId]['keyWords'] != {} %}
                <div class="block">
                    <h1>Słowa kluczowe:</h1>
                    {% for keyWordKey, keyWord in scenario['questions'][questionId]['keyWords'].items() %}
                        <p><input name='keyWord{{ keyWordKey }}' type="text" required="required" value="{{ keyWord }}"></p>
                        <p><a class="deleteButton" href="{{ url_for('delete', keyWordId=keyWordKey) }}">Usuń słowo kluczowe</a></p>
                    {% endfor %}
                </div>
            {% endif %}
            {% if scenario['questions'][questionId]['optionalTexts'] != {} %}
                <div class="block">
                    <h1>Tekst opcjonalny:</h1>
                    {% for optionalTextKey, optionalText in scenario['questions'][questionId]['optionalTexts'].items() %}
                        <h2>Treść tekstu {{ optionalTextKey|int + 1 }} :</h2>
                        <p><input name='optionalText{{ optionalTextKey }}' type="text" required="required" value="{{ optionalText['text'] }}"></p>
                        <h3>Pytanie warunkowe:</h3>
                        <p><select name="optionalTextConditionalAnswerId{{ optionalTextKey }}">
                            <option value="" selected="selected">Żadne</option>
                            {% for questionKey, question in scenario['questions'].items() %}
                                {% for answerKey, answer in question['answers'].items() %}
                                    <option value="{{ questionKey }}-{{ answerKey }}"{% if scenario['questions'][questionId]['optionalTexts'][optionalTextKey]['conditionalAnswerId'] == questionKey+"-"+answerKey %} selected="selected"{% endif %}>{{ answer['text'] }} -> {{ question['text'] }}</option>
                                {% endfor %}
                            {% endfor %}
                        </select></p>
                        <h3>Pytanie wykluczające:</h3>
                        <p><select name="optionalTextExclusionAnswerId{{ optionalTextKey }}">
                            <option value="" selected="selected">Żadne</option>
                            {% for questionKey, question in scenario['questions'].items() %}
                                {% for answerKey, answer in question['answers'].items() %}
                                    <option value="{{ questionKey }}-{{ answerKey }}"{% if scenario['questions'][questionId]['optionalTexts'][optionalTextKey]['exclusionAnswerId'] == questionKey+"-"+answerKey %} selected="selected"{% endif %}>{{ answer['text'] }} -> {{ question['text'] }}</option>
                                {% endfor %}
                            {% endfor %}
                        </select></p>
                        <p><a class="deleteButton" href="{{ url_for('delete', optionalTextId=optionalTextKey) }}">Usuń tekst opcjonalny</a></p>
                    {% endfor %}
                </div>
            {% endif %}
            {% if scenario['questions'][questionId]['answers'] != {} %}
                <div class="block">
                    <h1>Odpowiedzi:</h1>
                    {% for answerKey, answer in scenario['questions'][questionId]['answers'].items() %}
                        <h2>Treść odpowiedzi {{ answerKey|int + 1 }} :</h2>
                        <p><input name='answerText{{ answerKey }}' type="text" required="required" value="{{ answer['text'] }}"></p>
                        <h3>Pytanie docelowe:</h3>
                        <p><select name="answerQuestionId{{ answerKey }}">
                            {% for questionKey, question in scenario['questions'].items() %}
                                <option value="{{ questionKey }}"{% if scenario['questions'][questionId]['answers'][answerKey]['questionId'] == questionKey %} selected="selected"{% endif %}>{{ question['text'] }}</option>
                            {% endfor %}
                        </select></p>
                        <h3>Pytanie warunkowe:</h3>
                        <p><select name="answerConditionalAnswerId{{ answerKey }}">
                            <option value="" selected="selected">Żadne</option>
                            {% for questionKey, question in scenario['questions'].items() %}
                                {% for answerKey, answer in question['answers'].items() %}
                                    <option value="{{ questionKey }}-{{ answerKey }}"{% if scenario['questions'][questionId]['answers'][answerKey]['conditionalAnswerId'] == questionKey+"-"+answerKey %} selected="selected"{% endif %}>{{ answer['text'] }} -> {{ question['text'] }}</option>
                                {% endfor %}
                            {% endfor %}
                        </select></p>
                        <h3>Pytanie wykluczające:</h3>
                        <p><select name="answerExclusionAnswerId{{ answerKey }}">
                            <option value="" selected="selected">Żadne</option>
                            {% for questionKey, question in scenario['questions'].items() %}
                                {% for answerKey, answer in question['answers'].items() %}
                                    <option value="{{ questionKey }}-{{ answerKey }}"{% if scenario['questions'][questionId]['answers'][answerKey]['exclusionAnswerId'] == questionKey+"-"+answerKey %} selected="selected"{% endif %}>{{ answer['text'] }} -> {{ question['text'] }}</option>
                                {% endfor %}
                            {% endfor %}
                        </select></p>
                        <p><a class="deleteButton" href="{{ url_for('delete', answerId=answerKey) }}">Usuń odpowiedź</a></p>
                    {% endfor %}
                </div>
            {% endif %}
            <p><input type="submit" value="Zatwierdź zmiany"></p>
        </form>
    </div>
{% endblock %}